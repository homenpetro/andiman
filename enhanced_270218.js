function registerRemoveProductFromCartInNavBar(){$(".cart-container").on("click",".cartSkuRemove",function(e){console.log("---- Se dio click al remover el producto");var o=$(e.target).parent().parent().parent().find(".cartSkuName").first().text(),r=$(e.target).parent().parent().parent().find(".vtexsc-skuQtt").first().text();if(void 0!==o&&void 0!==r){var s=ECStorage.getAllObjects()[o];void 0!==s&&(console.log("Producto a retirar del carro: Qty: "+r),console.log(s),dataLayer.push({event:"removeFromCart",productToRemoveECData:{ecommerce:{currencyCode:"COP",remove:{products:[s]}}}}),ECStorage.deleteObject(s))}})}function registerAddToCartInProductPage(){$(".product-add-to-cart").on("click",function(e,o){try{if(void 0!=dataLayer[1].productId){var r={brand:dataLayer[1].productBrandName,category:dataLayer[1].productDepartmentName+"/"+dataLayer[1].productCategoryName,id:dataLayer[1].productId,name:dataLayer[1].productName,price:parseInt(dataLayer[1].productPriceTo)};ECImpressions.addToCart(r)}}catch(e){console.log(e)}})}function registerAddToCartInProductPage2(){try{var e={brand:dataLayer[1].productBrandName,category:dataLayer[1].productDepartmentName+"/"+dataLayer[1].productCategoryName,id:dataLayer[1].productId,name:dataLayer[1].productName,price:parseInt(dataLayer[1].productPriceTo)};ECImpressions.addToCart(e)}catch(e){console.log(e)}}var ECImpressions={impressionsBatchSize:20,impressions:[],currentImpressions:[],impressionsSentToGTM:0,push:function(e){e.position=ECImpressions.impressions.length+1;var o=window.location.pathname;void 0!=window.location.search&&null!=window.location.search&&""!=window.location.search&&(o+=window.location.search),e.list=o,ECImpressions.impressions.push(e),ECImpressions.currentImpressions.push(e),ECImpressions.impressions.length%ECImpressions.impressionsBatchSize==0&&(dataLayer.push({productImpressionsECData:void 0}),dataLayer.push({event:"enhancedEcommerceImpressions",productImpressionsECData:{ecommerce:{impressions:ECImpressions.currentImpressions}}}),ECImpressions.impressionsSentToGTM++,ECImpressions.currentImpressions=[])},sendPendingImpressions:function(){ECImpressions.currentImpressions.length>0&&(dataLayer.push({productImpressionsECData:void 0}),dataLayer.push({event:"enhancedEcommerceImpressions",productImpressionsECData:{ecommerce:{impressions:ECImpressions.currentImpressions}}}),ECImpressions.impressionsSentToGTM++,ECImpressions.currentImpressions=[])},fixProductName:function(e){return fixedName=e.replace(/&quot;/g,'"'),fixedName},fixBrand:function(e){return fixedBrand=$(e).html(),fixedBrand.toUpperCase()},fixPrice:function(e){return e=(e=(e=e.replace(",00","")).replace("$","")).replace(/\./g,""),intPrice=parseInt(e),0==intPrice&&(intPrice=void 0),intPrice},fixCategory:function(e,o){return e+"/"+o},productClick:function(e){console.log("Se dio click al producto:"+e);var o=window.location.pathname;void 0!=window.location.search&&null!=window.location.search&&""!=window.location.search&&(o+=window.location.search),productClickECEvent={event:"productClick",productClickECData:{ecommerce:{click:{actionField:{list:o},products:[e]}}}},dataLayer.push(productClickECEvent)},getProductName:function(e){return $("#"+e).text()},addToCart:function(e){console.log("Se dio click addToCart:"+e);var o=window.location.pathname;void 0!=window.location.search&&null!=window.location.search&&""!=window.location.search&&(o+=window.location.search),productAddECEvent={event:"addToCart",productClickECData:{ecommerce:{click:{actionField:{list:o},products:[e]}}}},dataLayer.push(productAddECEvent)}},ECPromoImpressions={impressionsBatchSize:20,impressions:[],currentImpressions:[],impressionsSentToGTM:0,push:function(e){ECPromoImpressions.impressions.push(e),ECPromoImpressions.currentImpressions.push(e),ECPromoImpressions.impressions.length%ECPromoImpressions.impressionsBatchSize==0&&(dataLayer.push({event:"enhancedEcommercePromoImpressions",promoImpressionsECData:{ecommerce:{promoView:{promotions:ECPromoImpressions.currentImpressions}}}}),ECPromoImpressions.impressionsSentToGTM++,ECPromoImpressions.currentImpressions=[])},promoClick:function(e){var o={event:"promotionClick",promoClickECData:{ecommerce:{promoClick:{promotions:[e]}}}};dataLayer.push(o)},sendPendingImpressions:function(){ECPromoImpressions.currentImpressions.length>0&&(dataLayer.push({promoImpressionsECData:void 0}),dataLayer.push({event:"enhancedEcommercePromoImpressions",promoImpressionsECData:{ecommerce:{promoView:{promotions:ECPromoImpressions.currentImpressions}}}}),ECPromoImpressions.impressionsSentToGTM++,ECPromoImpressions.currentImpressions=[])}},ECStorage={name:"ec_ga_products",saveObject:function(e){var o=ECStorage.getAllObjects();(o=o||{})[e.name]=e,localStorage.setItem(ECStorage.name,JSON.stringify(o))},deleteObject:function(e){var o=ECStorage.getAllObjects();delete(o=o||{})[e.name],localStorage.setItem(ECStorage.name,JSON.stringify(o))},getAllObjects:function(){return JSON.parse(localStorage.getItem(ECStorage.name))||{}}};$(document).ready(function(){registerRemoveProductFromCartInNavBar(),registerAddToCartInProductPage(),ECImpressions.sendPendingImpressions(),$("[data-position]").each(function(){var e=$(this).attr("data-position");if(e.length){var o,r="";$(this).find("img").length?r=(r=$(this).find("img").attr("data-src")?$(this).find("img").attr("data-src").split("/"):$(this).find("img").attr("src").split("/"))[r.length-1].replace(".jpg",""):r=(r=$(this).attr("data-src")?$(this).attr("data-src").split("/"):$(this).css("background-image").split("/"))[r.length-1].replace(/^url|[\(\)"]/g,"").replace(".jpg",""),o={id:r,name:r,creative:r,position:e},ECPromoImpressions.push(o),$(this).on("click",function(){ECPromoImpressions.promoClick(o)})}}),ECPromoImpressions.sendPendingImpressions()});